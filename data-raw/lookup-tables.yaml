naming:
  medDict: aurum_med_dict_dec24
  productDict: aurum_prod_dict_dec24
  icd10Dict: icd10_dict
  opcs4Dict: opsc_dict
keys:
  medDict: "medcodeid"
  productDict: "prodcodeid"
  icd10Dict: "icd10"
  opcs4Dict: "opcs4"
paths:
  medDict: "{refPath}/202412_EMISMedicalDictionary.txt"
  productDict: "{refPath}/202412_EMISProductDictionary.txt"
  icd10Dict: "{refPath}/ICD10_code_dictionary.txt"
  opcs4Dict: "{refPath}/OPCS4_code_dictionary.txt"
tables:
  medDict:
    drop: |
      DROP TABLE IF EXISTS {dataDb}.{medDict}
    create: |
      CREATE TABLE IF NOT EXISTS {dataDb}.{medDict}
      (medcodeid BIGINT,
      term VARCHAR(255),
      originalreadcode VARCHAR(100),
      cleansedreadcode VARCHAR(7),
      snomedctconceptid BIGINT UNSIGNED,
      snomedctdescriptionid BIGINT UNSIGNED,
      releaseid VARCHAR(100),
      emiscodecatid TINYINT,
      observations BIGINT,
      PRIMARY KEY (medcodeid))
      ENGINE=MYISAM
      CHARSET=latin1 COLLATE=latin1_general_ci;
    load: |
      LOAD DATA INFILE '{path}' IGNORE
      INTO TABLE {dataDb}.{medDict}
      FIELDS TERMINATED BY '\t'
      LINES TERMINATED BY '\r\n'
      IGNORE 1 LINES
      (medcodeid, observations, originalreadcode, @orig_cleansedreadcode, term, snomedctconceptid, snomedctdescriptionid, @orig_releaseid, emiscodecatid)
      SET cleansedreadcode = NULLIF(@orig_cleansedreadcode,''),
      releaseid = NULLIF(@orig_releaseid,'');
  productDict:
    drop: |
      DROP TABLE IF EXISTS {dataDb}.{productDict};
    create: |
      CREATE TABLE IF NOT EXISTS {dataDb}.{productDict}
      (prodcodeid BIGINT,
      dmdid BIGINT UNSIGNED,
      termfromemis VARCHAR(255),
      productname VARCHAR(999),
      formulation VARCHAR(999),
      routeofadministration VARCHAR(999),
      drugsubstancename VARCHAR(999),
      substancestrength VARCHAR(999),
      bnfchapter VARCHAR(999),
      drugissues BIGINT,
      PRIMARY KEY (prodcodeid))
      ENGINE=MYISAM
      CHARSET=latin1 COLLATE=latin1_general_ci;
    load: |
      LOAD DATA INFILE '{path}' IGNORE
      INTO TABLE {dataDb}.{productDict}
      FIELDS TERMINATED BY '\t'
      LINES TERMINATED BY '\r\n'
      IGNORE 1 LINES
      (prodcodeid, @orig_dmdid, @orig_termfromemis, @orig_productname, @orig_formulation, @orig_routeofadministration, @orig_drugsubstancename, @orig_substancestrength, @orig_bnfchapter, drugissues)
      SET dmdid = NULLIF(@orig_dmdid,''),
      termfromemis = @orig_termfromemis,
      productname = IF(@orig_productname='',@orig_termfromemis,@orig_productname),
      formulation = NULLIF(@orig_formulation,''),
      routeofadministration = NULLIF(@orig_routeofadministration,''),
      drugsubstancename = NULLIF(@orig_drugsubstancename,''),
      substancestrength = NULLIF(@orig_substancestrength,''),
      bnfchapter = NULLIF(@orig_bnfchapter,'');
  icd10Dict:
    drop: |
      DROP TABLE IF EXISTS {dataDb}.{icd10Dict}
    create: |
      CREATE TABLE IF NOT EXISTS {dataDb}.{icd10Dict}
      (icd10 VARCHAR(6),
      alt_code VARCHAR(5),
      usage_uk TINYINT,
      description VARCHAR(200),
      modifier_4 VARCHAR(100),
      modifier_5 VARCHAR(100),
      qualifiers VARCHAR(200),
      gender_mask TINYINT,
      min_age TINYINT,
      max_age TINYINT,
      tree_description VARCHAR(200),
      PRIMARY KEY (icd10))
      ENGINE=MYISAM
      CHARSET=latin1 COLLATE=latin1_general_ci;
    load: |
      LOAD DATA INFILE '{path}' IGNORE
      INTO TABLE {dataDb}.{icd10Dict}
      FIELDS TERMINATED BY '\t'
      LINES TERMINATED BY '\n'
      IGNORE 1 LINES
      (icd10, alt_code, usage_uk, description, @modifier_4, @modifier_5, @qualifiers, @gender_mask, @min_age, @max_age, @tree_description)
      SET modifier_4 = NULLIF(@modifier_4,''),
      modifier_5 = NULLIF(@modifier_5,''),
      qualifiers = NULLIF(@qualifiers,''),
      gender_mask = NULLIF(@gender_mask,''),
      min_age = NULLIF(@min_age,''),
      max_age = NULLIF(@max_age,''),
      tree_description = NULLIF(@tree_description,'');
  opcs4Dict:
    drop: |
      DROP TABLE IF EXISTS {dataDb}.{opcs4Dict}
    create: |
      CREATE TABLE IF NOT EXISTS {dataDb}.{opcs4Dict}
      (code VARCHAR(5),
      description VARCHAR(200),
      PRIMARY KEY (opcs4))
      ENGINE=MYISAM
      CHARSET=latin1 COLLATE=latin1_general_ci;
    load: |
      LOAD DATA INFILE '{path}' IGNORE
      INTO TABLE {dataDb}.{opcs4Dict}
      FIELDS TERMINATED BY '\t'
      LINES TERMINATED BY '\r\n'
      IGNORE 1 LINES
      (opcs4, description);
